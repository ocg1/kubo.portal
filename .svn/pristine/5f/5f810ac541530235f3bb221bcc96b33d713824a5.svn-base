package mx.com.kubo.mesa.solicitud.perfil.domicilio;

import java.util.ArrayList;

import mx.com.kubo.model.Address;
import mx.com.kubo.model.gnNaturalPersonPK;

public abstract class DomicilioAMO extends DomicilioDMO 
{
	protected void init_coincidencias() 
	{
		coincidencias_NIVEL_1 = service_address.getCoincidencias_NUMBER(NIVEL_1, address);
		coincidencias_NIVEL_2 = service_address.getCoincidencias_NUMBER(NIVEL_2, address);		
		
		if(coincidencias_NIVEL_1 != null)
		{
			if(coincidencias_NIVEL_1 > 1)
			{		
				alarma_NIVEL_1 = coincidencias_NIVEL_1 + " personas más viven en la misma calle";
				
				if(address_type_id > 1 && address_type_id < 5)
				{
					alarma_NIVEL_1 = coincidencias_NIVEL_1 + " personas más trabajan en la misma calle";
				}				
			} 
			
			if(coincidencias_NIVEL_1 == 1)
			{
				alarma_NIVEL_1 = coincidencias_NIVEL_1 + " persona más vive en la misma calle";
				
				if(address_type_id > 1 && address_type_id < 5)
				{
					alarma_NIVEL_1 = coincidencias_NIVEL_1 + " persona más trabaja en la misma calle";
				}	
			}
		}
		
		if(coincidencias_NIVEL_2 != null)
		{
			if(coincidencias_NIVEL_2 > 1)
			{
				alarma_NIVEL_2 = coincidencias_NIVEL_2 + " personas más viven en el mismo domicilio";
				
				if(address_type_id > 1 && address_type_id < 5)
				{
					alarma_NIVEL_2 = coincidencias_NIVEL_2 + " personas más trabajan en el misma domicilio";
				}	
				
			} 
			
			if(coincidencias_NIVEL_2 == 1)
			{
				alarma_NIVEL_2 = coincidencias_NIVEL_2 + " persona más vive en el mismo domicilio";
				
				if(address_type_id > 1 && address_type_id < 5)
				{
					alarma_NIVEL_2 = coincidencias_NIVEL_2 + " persona más trabaja en el misma domicilio";
				}	
			}
		}
	}
	
	protected void init_lista_coincidencias() 
	{
		lista_coincidencias = new ArrayList<Coincidencia>(lista_address.size());
		
		for(Address domicilio: lista_address)
		{					
			coincidencia = new Coincidencia();
		
			prospectus_id = domicilio.getAddressPK().getProspectus_id();
			company_id    = domicilio.getAddressPK().getCompany_id();
			
			natural_person_PK = new gnNaturalPersonPK(prospectus_id, company_id);
			
			natural_person = service_natural_person.getNaturalPersonById(natural_person_PK);			
			proyect_loan   = service_proyect_loan.getMaxProyectLoanByProspect(prospectus_id, company_id);
			
			coincidencia.setAddress_type(domicilio.getAddress_type().getName());
			coincidencia.setNatural_person(natural_person);
			coincidencia.setProyect_loan(proyect_loan);
			
			token = new AddressTokenIMP();
			token.setAddress(domicilio);
			
			String vivienda_TOKEN = token.getAddress_empresa_TOKEN();
			
			coincidencia.setAddress_TOKEN(vivienda_TOKEN);			
		
			lista_coincidencias.add(coincidencia);
		}
	}
}
