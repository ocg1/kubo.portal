<ui:composition xmlns="http://www.w3.org/1999/xhtml"

		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:p="http://primefaces.org/ui">	
		
		<style style="text/css">
		    .animated .ui-progressbar-value { 
		        background-image: url("/showcase/javax.faces.resource/demo/images/pbar-ani.gif.xhtml"); 
		    }
		    
		    .ui-progressbar .ui-progressbar-value{
		    
		    margin: 0px !important;
		    
		    }
		</style>
		
		<script type = "text/javascript" src = "../resources/js/investmentAction.js" />
		
		<h:form prependId="false">
		
			<!-- Investment Action
			
			#{investmentAction.numProyectToInv}"
			 -->
			<h:panelGroup id = "pnlProgress" >
				<div id="dvProgressInv" >
					<div>
					
						<div>
							
							<div class="mensaje">Por favor espera un momento, tus inversiones est√°n en proceso ...</div>
							<div class="loader">
								<img src="../resources/img/ajax-loader.gif" />
							</div>
						</div>
					
						<div style="width: 310px; margin-left: auto; margin-right: auto;" >
						<!-- 
							<table>
								<tr>
									<td>Inversiones realizadas:</td>
									<td>#{investmentAction.proyectos}</td>
								</tr>
								<tr>
									<td>Inversiones NO realizadas:</td>
									<td>#{investmentAction.proyectosNoFondeados}</td>
								</tr>
								<tr>
									<td>Monto Invertido: </td>
									<td>
										
										<h:outputText value="#{investmentAction.montoinvertido}">
											<f:convertNumber maxFractionDigits="0" minFractionDigits="0" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
										</h:outputText>
									</td>
									
								</tr>
							</table>
						 -->
						 
				
						 
						</div>
					<!-- 
						<div style="width: 310px; margin-left: auto; margin-right: auto;margin-bottom: 15px;" >
					     
					     <p:progressBar id="progressBarClient" widgetVar="pbClient" labelTemplate="#{investmentAction.porcentaje}%" value="#{investmentAction.porcentaje}" style="width:300px; border: solid 1px #E6E6E6;" />
		 
		 				</div>
					 -->
					</div>
					
					<!-- <h:inputHidden id ="porcentage" value="#{investmentAction.porcentaje}" /> -->
				</div>
			</h:panelGroup>
			
			<div id="dvResumenInv">
				<h:panelGroup id="pnlUpdateInv" >
				
					<div>
									<h3 class="encabezado_3">Resumen de inversiones.</h3>
							
						<table class="table_resumenInv">
							<tr>
								<th> </th>
								<th> Proyectos </th>
								<th class="celda_monto"> Monto </th>
								<th>Tasa ponderada</th>
								<th>Plazo ponderado</th>
							</tr>
							<tr>
								<td> Inversiones <br/>realizadas </td>
								<td> #{investmentAction.proyectos} </td>
								<td>
									<h:outputText value="#{investmentAction.montoinvertido}">
										<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
									</h:outputText>
								</td>
								<td>
									
									<h:outputText value="#{investmentAction.tasaPonderada}" >
										<f:convertNumber pattern="#0.00"  locale="es_MX" />									
									</h:outputText>%
									
									
								
								</td>
								<td class="sumaDiasPonderados"> 
								<span></span>
								<div class="ui-icon ui-icon-triangle-1-s invDesc" ></div>
								</td>
								
							</tr>
							
							<tr>
								<td colspan="5">
									<div id="dvInvDesc" style="display:none; margin-top: 8px; margin-bottom: 8px; margin-left: auto; margin-right: auto;">
										<div class="loader" id="dvWaitInv">
											<img src="../resources/img/ajax-loader.gif" />
										</div>
										
										<div id="dvInfInv" style="display: none;">
										</div>
										
										<table class="monto_total_inv" cellspacing="0" cellpadding="0">
											<tr class="bordeTotales">
										
											
												<td>
													Total
												</td>	
												<td class="celda_monto_total_inv">
													<div>
														
														<strong>
															<h:outputText value="#{investmentAction.montoinvertido}">
															<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
															</h:outputText>
														</strong>
													</div>
												</td>
														<td>	
												
												<h:outputText value="#{investmentAction.tasaPonderada}" >
													<f:convertNumber pattern="#0.00"  locale="es_MX" />									
												</h:outputText>%<sup>*</sup>
												
									</td>	
												<td class="sumaDiasPonderados">
												<span></span>**
												</td>
												
										
										
												
											</tr>
											<tr>
												<td  colspan="5" class="pie_tasa">
													<p>*Tasa Ponderada</p>
													<p>**Plazo ponderado</p>
												</td>
											</tr>
										</table>
									</div>
								</td>
							</tr>
							
							<!-- 
							<tr>
								<td colspan="4">
									<div id="dvInvDesc" style="display:none; margin-top: 8px; margin-bottom: 8px; margin-left: auto; margin-right: auto;">
										<table style="margin-left: auto;margin-right: auto;">
											<tr>
												<th style="padding-right: 35px;">Proyecto</th>
												<th style="padding-right: 35px;">Riesgo</th>
												<th>Monto</th>
											</tr>
											<ui:repeat id="investmentlst" var="invItem" value="#{investmentAction.listToInv}" varStatus="status">
												<h:panelGroup rendered="#{invItem.status == '1'}">
													<tr>
														<td style="padding-right: 35px;">#{invItem.proyect_loan_id}</td>
														<td style="padding-right: 35px;">
															<div class="dvRisk#{invItem.kubo_score_a}">
																<p class="statusLeft">#{invItem.kubo_score_a}</p>
																<p class="statusRight">#{invItem.kubo_score_b}</p>
															</div>
														</td>
														<td style="padding-left: 10px; padding-right: 10px; text-align: right;">
															
															<h:outputText value="#{invItem.ammount}">
																<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
															</h:outputText>
															
														</td>
													</tr>
												</h:panelGroup>
											</ui:repeat>
										</table>
									</div>
								</td>
							</tr>
							-->
							<tr style="border-top: solid 1px #E6E6E6;">
								<td style="border-top: solid 1px #E6E6E6; padding-top: 5px;" >Inversiones No realizadas </td>
								<td style="border-top: solid 1px #E6E6E6; padding-top: 5px;" > #{investmentAction.proyectosNoFondeados} </td>
								<td style="border-top: solid 1px #E6E6E6; padding-top: 5px;"  >
									<h:outputText value="#{investmentAction.montoNOinvertido}">
										<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
									</h:outputText>
								</td>
								<td  style="border-top: solid 1px #E6E6E6; padding-top: 5px;"></td>
								<td style="border-top: solid 1px #E6E6E6;" >
									<div class="ui-icon ui-icon-triangle-1-s noInvDesc" ></div>
								</td>
							</tr>
							
							<tr>
								<td colspan="5">
									<div id="dvNoInvDesc" style="display:none; margin-top: 8px; margin-bottom: 8px; margin-left: auto; margin-right: auto;">
										<div class="loader" id="dvWaitNoInv">
											<img src="../resources/img/ajax-loader.gif" />
										</div>
										<div id="dvInfNoInv" style="display: none;">
										</div>
									</div>
								</td>
							</tr>
							
							<!-- 
							<tr>
								<td colspan="4">
									<div id="dvNoInvDesc" style="display:none; margin-top: 8px; margin-bottom: 8px; margin-left: auto; margin-right: auto;">
										<table style="margin-left: auto;margin-right: auto;">
											<tr>
												<th style="padding-right: 35px;">Proyecto</th>
												<th style="padding-right: 35px;">Riesgo</th>
												<th style="padding-right: 35px;">Monto</th>
												<th>Motivo</th>
											</tr>
											
											<ui:repeat id="investmentlstNo" var="invItem" value="#{investmentAction.listToInv}" varStatus="status">
												<h:panelGroup rendered="#{invItem.status eq '0'}">
													<tr>
														<td style="padding-left: 10px; padding-right: 35px;">#{invItem.proyect_loan_id}</td>
														<td style="padding-left: 10px; padding-right: 35px;">
															<div class="dvRisk#{invItem.kubo_score_a}">
																<p class="statusLeft">#{invItem.kubo_score_a}</p>
																<p class="statusRight">#{invItem.kubo_score_b}</p>
															</div>
														</td>
														<td style="padding-left: 10px; padding-right: 35px; text-align: right;">
															<h:outputText value="#{invItem.ammount}">
																<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>									
															</h:outputText>
														</td>
														<td style="padding-left: 10px; padding-right: 10px;">#{invItem.motivo}</td>
													</tr>
												</h:panelGroup>
											</ui:repeat>
											
										</table>
										
									</div>
								</td>
							</tr>
							 -->
							
							
						</table>
						
						<div class="botones_resumeninv" > 
						
								<p:commandLink id="buscar_proyectos" styleClass="callActionMedium  btnVerde-2"  value="Buscar mas proyectos" actionListener="#{navigationInvest.changePage}" onstart="displayMessageProcessing('msgprocessing',false);" oncomplete="invertir_function2();" update=":pnlContentInvest :panelContentListProyect" >
									<f:attribute name="seccionInv" value="returnProyectListInvest" />
								</p:commandLink>
						
								<p:commandLink id="resumen_saldos"  styleClass="callActionMedium  btnVerde" value="Estado de Cuenta" actionListener="#{navigationInvest.changePage}" onstart="displayMessageProcessing('msgprocessing',false);" oncomplete="resumen_saldos();" update=":pnlContentInvest :panelContentListProyect">
									<f:attribute name="seccionInv" value="investments" />
								</p:commandLink>
							
						</div>
					</div>
				
				</h:panelGroup>
			</div>
			
			<div style="display:none">
		
				<h:commandLink id="cmdUpdateInv" value="actualiza" immediate="true"  style="text-decoration: none;" ajax="true" >
				
					<p:ajax event="click" update="pnlProgress" />
				
				</h:commandLink>
				
				<h:commandLink id="cmdActionInv" value="inicio" immediate="true"  style="text-decoration: none;" ajax="true" >
				
					<!-- <p:ajax  listener="#{investmentAction.investmentActionFnc}" onstart="return returnInitInv();"  event="click" update="pnlProgress" /> -->
					
					<p:ajax listener="#{investmentAction.investmentActionFnc}" oncomplete="return completeInv();"  event="click" update="pnlUpdateInv" />
				
				</h:commandLink>
				
				<h:commandLink id="cmdCompleteInv" value="inicio" immediate="true"  style="text-decoration: none;" ajax="true" >
				
					<p:ajax oncomplete="return completeInv();"  event="click" update="pnlUpdateInv" />
				
				</h:commandLink>
				
				<h:commandLink id="cmdCargaInv" value="carga" immediate="true"  style="text-decoration: none;" ajax="true" >
				
					<p:ajax oncomplete="completaCargaInv(xhr, status, args);" listener="#{investmentAction.procesaInversiones}" event="click" />
				
				</h:commandLink>
				
				<h:commandLink id="cmdCargaNoInv" value="cargaNoInv" immediate="true"  style="text-decoration: none;" ajax="true" >
				
					<p:ajax oncomplete="completaCargaNoInv(xhr, status, args);" listener="#{investmentAction.procesaNoInversiones}" event="click" />
				
				</h:commandLink>
				
			</div>
			
		</h:form>
		
		<script>
		
		$(document).ready(function(){
			
			setTimeout(function(){ iniInvest(); }, 500);
			
			
		});
		
		</script>
		
		
</ui:composition>